require 'uri'
require 'net/http'
require 'digest/sha1'
require 'json'

data = [[[36.55928375, 139.89827331], 290],
        [[36.55928809, 139.89832447], 267],
        [[36.5592928, 139.89845666], 188],
        [[36.55929925, 139.89845625], 193],
        [[36.55930513, 139.89846069], 204],
        [[36.55930694, 139.89852725], 4],
        [[36.55930397, 139.89854941], 324],
        [[36.55930223, 139.89855756], 266],
        [[36.55930154, 139.89855824], 69],
        [[36.55930163, 139.89856038], 12],
        [[36.55931726, 139.89865494], 100],
        [[36.55931893, 139.8986647], 293],
        [[36.559319, 139.89866947], 68],
        [[36.5593181, 139.89867873], 228],
        [[36.55931634, 139.8986859], 150],
        [[36.55931654, 139.89868584], 74],
        [[36.55931763, 139.89868011], 262],
        [[36.55931749, 139.89868146], 199],
        [[36.55931636, 139.89867608], 235],
        [[36.55931568, 139.89867793], 203],
        [[36.55931539, 139.89868035], 21],
        [[36.55931405, 139.89868328], 16],
        [[36.55931389, 139.8986864], 146],
        [[36.55931369, 139.89869186], 76],
        [[36.55931374, 139.89869184], 158],
        [[36.55931352, 139.89869207], 30],
        [[36.5593135, 139.89869186], 123],
        [[36.55931352, 139.89869137], 60],
        [[36.55931378, 139.89869194], 314],
        [[36.55931366, 139.89869145], 67],
        [[36.55931347, 139.89869208], 195],
        [[36.55931322, 139.89869032], 257],
        [[36.55931329, 139.89869248], 180],
        [[36.55931335, 139.89869395], 359],
        [[36.55931358, 139.89869209], 7],
        [[36.55932663, 139.89861577], 1],
        [[36.5610584, 139.89887431], 18],
        [[36.56204445, 139.89914175], 210],
        [[36.5763368, 139.91230935], 349],
        [[36.57821725, 139.91506993], 55],
        [[36.58016471, 139.9179093], 186],
        [[36.58213839, 139.92070528], 239],
        [[36.58403486, 139.92359684], 56],
        [[36.58603813, 139.92641364], 13],
        [[36.58794915, 139.92920585], 187],
        [[36.58983733, 139.93191711], 147],
        [[36.59156852, 139.93454199], 139],
        [[36.59317477, 139.9370273], 78],
        [[36.59483071, 139.93942231], 271],
        [[36.59654805, 139.94175619], 342],
        [[36.59790217, 139.94356028], 246],
        [[36.59855013, 139.94442672], 44],
        [[36.59863627, 139.94455096], 68],
        [[36.59859783, 139.94454743], 230],
        [[36.59856677, 139.94455177], 205],
        [[36.59852113, 139.94452098], 75],
        [[36.59850009, 139.94460488], 257],
        [[36.59875442, 139.94489684], 117],
        [[36.59942343, 139.94589981], 307],
        [[36.60042517, 139.94741172], 358],
        [[36.60172885, 139.94944762], 84],
        [[36.60335278, 139.95184232], 0],
        [[36.60523939, 139.95467056], 14],
        [[36.60706168, 139.9572809], 326],
        [[36.60890894, 139.96005875], 19],
        [[36.61019323, 139.96332575], 339],
        [[36.61078766, 139.96658213], 62],
        [[36.61098779, 139.96973435], 139],
        [[36.61125681, 139.97276309], 244],
        [[36.61168888, 139.97573455], 236],
        [[36.61325397, 139.97806302], 281],
        [[36.61559169, 139.97921451], 264],
        [[36.61792821, 139.97986086], 317],
        [[36.62056087, 139.98068945], 298],
        [[36.62314297, 139.9809381], 288],
        [[36.62550435, 139.98059836], 70],
        [[36.62771621, 139.98019993], 320],
        [[36.6296486, 139.97978801], 316],
        [[36.63089155, 139.97956767], 247],
        [[36.63121248, 139.9795231], 214],
        [[36.63124664, 139.97947711], 267],
        [[36.63126113, 139.97946652], 265],
        [[36.63126138, 139.97946645], 153],
        [[36.63133972, 139.97943251], 229],
        [[36.63196812, 139.97930321], 261],
        [[36.63326575, 139.97914251], 99],
        [[36.63507947, 139.97877749], 211],
        [[36.63731297, 139.97832523], 111],
        [[36.63979997, 139.97788877], 159],
        [[36.64249759, 139.97715155], 237],
        [[36.64787393, 139.97410441], 314],
        [[36.65026237, 139.97256857], 148],
        [[36.65280777, 139.971037], 165],
        [[36.65554715, 139.9701392], 330],
        [[36.65852908, 139.96943413], 69],
        [[36.66139464, 139.96866684], 354],
        [[36.66406203, 139.96800899], 257],
        [[36.66674262, 139.96732206], 100],
        [[36.66913386, 139.96652458], 132],
        [[36.67133379, 139.96583259], 68],
        [[36.67365678, 139.96498077], 213],
        [[36.67584919, 139.96418922], 103],
        [[36.67796768, 139.96346702], 311],
        [[36.67985072, 139.96259343], 51],
        [[36.68112633, 139.96222419], 121],
        [[36.68148354, 139.96198967], 105],
        [[36.68150712, 139.96197479], 74],
        [[36.6815051, 139.96195444], 262],
        [[36.68150566, 139.96195061], 241],
        [[36.68192747, 139.96193647], 239],
        [[36.68285471, 139.9615707], 55],
        [[36.68449676, 139.96108173], 244],
        [[36.68649556, 139.96037033], 212],
        [[36.68884214, 139.95934915], 316],
        [[36.69125932, 139.95830108], 32],
        [[36.69389195, 139.95730959], 53],
        [[36.6965005, 139.95657513], 157],
        [[36.69908044, 139.95591009], 315],
        [[36.70182744, 139.95522738], 104],
        [[36.70461309, 139.95453342], 107],
        [[36.70743229, 139.95384704], 291],
        [[36.71017502, 139.95311904], 185],
        [[36.71291929, 139.95244108], 5],
        [[36.71557211, 139.95179694], 135],
        [[36.71796468, 139.95112548], 328],
        [[36.72004703, 139.95045862], 161],
        [[36.72120939, 139.95019416], 352],
        [[36.72134557, 139.95015872], 339],
        [[36.72135168, 139.95014838], 329],
        [[36.72135244, 139.9501495], 253],
        [[36.72142403, 139.95017265], 52],
        [[36.72212098, 139.94999676], 341],
        [[36.72350289, 139.94967712], 72],
        [[36.7251964, 139.94937792], 316],
        [[36.72753648, 139.94959132], 149],
        [[36.73004426, 139.95005699], 1],
        [[36.73285077, 139.95069132], 259],
        [[36.73544209, 139.95117889], 102],
        [[36.73815952, 139.95169779], 20],
        [[36.74311845, 139.95221485], 224],
        [[36.74060804, 139.95214427], 10],
        [[36.7456125, 139.95154737], 262],
        [[36.74780516, 139.95011562], 92],
        [[36.74987386, 139.94875475], 123],
        [[36.75173476, 139.94746498], 227],
        [[36.75325527, 139.94634282], 91],
        [[36.75422376, 139.94573324], 71],
        [[36.75450695, 139.94551458], 345],
        [[36.7545242, 139.94550515], 142],
        [[36.75452327, 139.94550537], 130],
        [[36.75452263, 139.94550528], 227],
        [[36.75463175, 139.94538679], 72],
        [[36.7553248, 139.94497232], 196],
        [[36.756511, 139.94425706], 280],
        [[36.75809165, 139.94326695], 74],
        [[36.75987022, 139.94205874], 19],
        [[36.7620975, 139.94047237], 103],
        [[36.76443022, 139.9389494], 230],
        [[36.76684626, 139.93730338], 121],
        [[36.76939091, 139.93557245], 154],
        [[36.77180162, 139.93387621], 74],
        [[36.77412464, 139.93188943], 7],
        [[36.77649115, 139.93001718], 23],
        [[36.77898165, 139.92880018], 173],
        [[36.78187445, 139.92834302], 55],
        [[36.78455217, 139.92853975], 113],
        [[36.78737465, 139.92894771], 86],
        [[36.79002459, 139.92933312], 173],
        [[36.7928643, 139.92975275], 242],
        [[36.79552902, 139.93013541], 190],
        [[36.79823304, 139.93054692], 287],
        [[36.80073296, 139.93096021], 216],
        [[36.80303807, 139.93153803], 66],
        [[36.80499673, 139.93227435], 181],
        [[36.80648541, 139.93282429], 193],
        [[36.80697051, 139.93301335], 202],
        [[36.80697115, 139.93299019], 126],
        [[36.80696786, 139.93298787], 265],
        [[36.80696903, 139.93298776], 265],
        [[36.80733612, 139.93313505], 78],
        [[36.80828575, 139.93351052], 196],
        [[36.80981628, 139.9340981], 343],
        [[36.81172323, 139.93475697], 345],
        [[36.81368228, 139.93570921], 313],
        [[36.81566622, 139.93740291], 9],
        [[36.81748942, 139.93968043], 120],
        [[36.81951529, 139.94214156], 270],
        [[36.82123724, 139.94476776], 199],
        [[36.82315836, 139.94678241], 100],
        [[36.82559358, 139.94729024], 175],
        [[36.82796892, 139.94730802], 2],
        [[36.83058464, 139.9474356], 80],
        [[36.83306784, 139.94871374], 179],
        [[36.83533589, 139.95064199], 282],
        [[36.83745133, 139.95250416], 253],
        [[36.83944267, 139.9542871], 228],
        [[36.84126886, 139.95587814], 155],
        [[36.84288935, 139.95722613], 260],
        [[36.8437965, 139.95791866], 36],
        [[36.84407294, 139.95808771], 179],
        [[36.84396385, 139.95799717], 342],
        [[36.84396217, 139.95799635], 350],
        [[36.84401346, 139.95801593], 292],
        [[36.84464939, 139.95848726], 189],
        [[36.84573537, 139.9592301], 314],
        [[36.84729913, 139.96036604], 239],
        [[36.8492162, 139.9616934], 328],
        [[36.85123884, 139.9631437], 298],
        [[36.85353821, 139.96475828], 50],
        [[36.85581813, 139.96633956], 181],
        [[36.85816551, 139.96796855], 303],
        [[36.86064654, 139.9697917], 8],
        [[36.86305793, 139.97155201], 137],
        [[36.8653092, 139.97316542], 183],
        [[36.86786212, 139.9749615], 185],
        [[36.87029758, 139.97666412], 44],
        [[36.87277026, 139.9783493], 35],
        [[36.87545303, 139.98028411], 228],
        [[36.87779633, 139.98186944], 290],
        [[36.87976228, 139.9833984], 206],
        [[36.88210856, 139.98513887], 79],
        [[36.88365138, 139.98628393], 350],
        [[36.88441388, 139.98679957], 298],
        [[36.88445282, 139.98686196], 222],
        [[36.88448107, 139.9867634], 38],
        [[36.88447925, 139.98676503], 220],
        [[36.88425452, 139.98675657], 149],
        [[36.88421947, 139.98670174], 285],
        [[36.88428306, 139.98681442], 37],
        [[36.88424631, 139.9868103], 240],
        [[36.88426073, 139.98672642], 253],
        [[36.88451229, 139.98638786], 121],
        [[36.88455605, 139.98639977], 39],
        [[36.88449917, 139.98638399], 331],
        [[36.88460501, 139.98622558], 65],
        [[36.88466629, 139.98610377], 80],
        [[36.88473358, 139.98615782], 114],
        [[36.88469459, 139.98615869], 274],
        [[36.88451167, 139.98599032], 70],
        [[36.88441472, 139.98584442], 303],
        [[36.88450585, 139.98565768], 80],
        [[36.88458983, 139.98548864], 354],
        [[36.8846419, 139.98527298], 26],
        [[36.88469704, 139.98508055], 13],
        [[36.88471581, 139.98493403], 145],
        [[36.88480329, 139.98478553], 201],
        [[36.88489238, 139.98462177], 326],
        [[36.88492749, 139.9844234], 165],
        [[36.88503049, 139.9842796], 269],
        [[36.88511244, 139.98412404], 162],
        [[36.88521155, 139.98399116], 246],
        [[36.88524882, 139.98388981], 50],
        [[36.88530196, 139.98373473], 215],
        [[36.88538871, 139.98357915], 301],
        [[36.88547201, 139.98347963], 36],
        [[36.88549225, 139.98329916], 356],
        [[36.88560566, 139.98316163], 258],
        [[36.88567646, 139.98299664], 60],
        [[36.88574641, 139.98297474], 348],
        [[36.88575163, 139.98295638], 235],
        [[36.88577742, 139.98280353], 66],
        [[36.88578697, 139.98257675], 230],
        [[36.88577438, 139.98230614], 151],
        [[36.88579537, 139.9821734], 312],
        [[36.88583226, 139.98205131], 347],
        [[36.88584688, 139.98180738], 146],
        [[36.8858778, 139.98165574], 327],
        [[36.88588995, 139.9814515], 253],
        [[36.88585945, 139.98128019], 184],
        [[36.8858775, 139.98111139], 268],
        [[36.88594243, 139.98090135], 111],
        [[36.88593589, 139.9806966], 211],
        [[36.88595324, 139.98057009], 6],
        [[36.88592867, 139.9803266], 165],
        [[36.88596927, 139.98021354], 301],
        [[36.88602986, 139.98003898], 16],
        [[36.88602958, 139.97982869], 315],
        [[36.88601179, 139.97972274], 79],
        [[36.88608439, 139.97948962], 121],
        [[36.88612585, 139.97937561], 252],
        [[36.88597567, 139.97927925], 269],
        [[36.88597529, 139.97907029], 204],
        [[36.88594418, 139.97889646], 114],
        [[36.88589166, 139.97876277], 241],
        [[36.88576474, 139.97861889], 356],
        [[36.88564799, 139.97849885], 128],
        [[36.88553883, 139.97838073], 18],
        [[36.8854383, 139.97826059], 42],
        [[36.88532714, 139.97814231], 93],
        [[36.88521801, 139.97800189], 240],
        [[36.88511489, 139.97788391], 145],
        [[36.88501368, 139.97776158], 90],
        [[36.88487816, 139.97760128], 32],
        [[36.88477077, 139.97753722], 212],
        [[36.88484767, 139.97735573], 350],
        [[36.88476744, 139.97719564], 214]]

endpoint = URI.parse(ARGV[0])
token = ARGV[1]


Net::HTTP.start(endpoint.host,endpoint.port) do |http|
  salt = http.get("/salt").body
  data.each_with_index do |d,i|
    result = JSON.parse(http.post("/location","latitude=#{d[0][0]}&longitude=#{d[0][1]}&heading=#{i*10}&speed=#{rand(100)}&address=#{rand(1000)}&token=#{Digest::SHA1.hexdigest(salt+token)}").body)
    p result
    if result["result"] == "success"
      salt = result["salt"]
    else
      exit
    end
    sleep [0.1].sample
  end
end
